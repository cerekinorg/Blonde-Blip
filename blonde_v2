#!/usr/bin/env python3
"""
Blonde CLI - v2.0 Launcher
Simple, working launcher using new simplified systems
"""

import sys
from pathlib import Path

# Add project root to path
PROJECT_ROOT = Path(__file__).parent
sys.path.insert(0, str(PROJECT_ROOT))

CONFIG_DIR = Path.home() / ".blonde"
CONFIG_FILE = CONFIG_DIR / "config.json"


def main():
    """Main launcher"""
    print("üé® Welcome to Blonde CLI v2.0!")

    # Ensure config directory exists
    CONFIG_DIR.mkdir(exist_ok=True)

    # Check if setup needed
    if not CONFIG_FILE.exists():
        print("Running setup...\n")

        # Simple setup
        try:
            import json
            default_config = {
                'provider': 'openrouter',
                'model': 'openai/gpt-4',
                'blip_character': 'axolotl',
                'setup_complete': True
            }
            CONFIG_FILE.parent.mkdir(parents=True, exist_ok=True)
            with open(CONFIG_FILE, 'w') as f:
                json.dump(default_config, f, indent=2)

            print("‚úÖ Setup complete!\n")

        except Exception as e:
            print(f"Setup error: {e}")
            sys.exit(1)

    # Launch TUI
    try:
        from tui.simple_dashboard import SimpleDashboard

        # Check if command line args passed
        if len(sys.argv) > 1:
            # CLI mode
            from tui.cli_simplified import app
            sys.argv[0] = sys.argv[0].replace(PROJECT_ROOT / "blonde", sys.argv[0])
            app()
        else:
            # TUI mode
            app = SimpleDashboard()
            app.run()

    except KeyboardInterrupt:
        print("\nüëã Goodbye!")
        sys.exit(0)
    except Exception as e:
        print(f"\n‚ùå Error: {e}")
        import traceback
        traceback.print_exc()
        sys.exit(1)


if __name__ == "__main__":
    main()
